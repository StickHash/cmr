{% extends 'content/base.html' %}
{% load custom_filters %}
{% block content %}
    <p>{{ message }}</p>
    <form method="POST" enctype="multipart/form-data" class="recipe-form">
        {% csrf_token %}
        <div class="field">
            {{ form.title.errors }}
            <label for="{{ form.title.id_for_label }}" class="label">Titre de la recette</label>
            {{ form.title|addclass:'input is-primary' }}
        </div>
        <div class="file has-name">
            {{ form.photo.errors }}
            <label for="{{ form.photo.id_for_label }}" class="file-label">
                {{ form.photo|addclass:"file-input" }}
                <span class="file-cta">
                  <span class="file-icon">
                    <i class="fa fa-upload"></i>
                  </span>
                  <span class="file-label">
                    Choisissez une photo
                  </span>
                </span>
                <span><figure class="image is-128x128">
                    <img src="" alt="" id="selected_image">
                </figure>
                    </span>
            </label>
        </div>
        {{ ingForm }}
        <input type="submit" value="Valider" class="button is-dark">
    </form>

    <script>
        fileselect = document.getElementById("id_photo")
        fileselect.addEventListener('change', putImage, false)

        function showImage(src, target) {
            var fr = new FileReader();
            fr.onload = function () {
                target.src = fr.result;
            }
            fr.readAsDataURL(src.files[0]);
        }

        function putImage() {
            var src = document.getElementById("id_photo");
            var target = document.getElementById("selected_image");
            showImage(src, target);
        }</script>
{% endblock %}
